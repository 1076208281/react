

<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Blog - React</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:title" content="Blog - React">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://discountry.github.io/react/blog/">
  <meta property="og:image" content="https://discountry.github.io/react/img/logo_og.png">
  <meta property="og:description" content="A JavaScript library for building user interfaces">
  <meta property="fb:app_id" content="623268441017527">

  <link rel="shortcut icon" href="/react/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="React" href="https://facebook.github.io/react/feed.xml">

  <link rel="stylesheet" href="/react/css/syntax.css">
  <link rel="stylesheet" href="/react/css/codemirror.css">
  <link rel="stylesheet" href="/react/css/react.css">

  <script src="https://use.typekit.net/qfl6nyj.js"></script>
  <script>try{Typekit.load({ async: true });}catch(e){}</script>

  <!--[if lte IE 8]>
  <script src="https://unpkg.com/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://unpkg.com/es5-shim@4.5.9/es5-shim.min.js"></script>
  <script src="https://unpkg.com/es5-shim@4.5.9/es5-sham.min.js"></script>
  <![endif]-->
  <script src="https://cdn.bootcss.com/codemirror/5.15.2/codemirror.min.js"></script>
  <script src="https://cdn.bootcss.com/codemirror/5.15.2/mode/javascript/javascript.min.js"></script>
  <script src="https://cdn.bootcss.com/codemirror/5.15.2/mode/xml/xml.min.js"></script>
  <script src="https://cdn.bootcss.com/codemirror/5.15.2/mode/jsx/jsx.min.js"></script>
  <script src="https://cdn.bootcss.com/react/15.5.4/react.min.js"></script>
  <script src="https://cdn.bootcss.com/react/15.5.4/react-dom.min.js"></script>
  <script src="https://cdn.bootcss.com/babel-standalone/6.15.0/babel.min.js"></script>
  <script src="/react/js/live_editor.js"></script>
</head>
<body>

  <div class="container">

    <div class="nav-main">
  <div class="wrap">
    <a class="nav-home" href="/react/">
      <img class="nav-logo" src="/react/img/logo.svg" width="36" height="36">
      React
    </a>
    <div class="nav-lists">
      <ul class="nav-site nav-site-internal">
        <li><a href="/react/docs/hello-world.html">文档</a></li>
        <li><a href="/react/tutorial/tutorial.html">教程</a></li>
        <li><a href="/react/community/support.html">社区</a></li>
        <li><a href="/react/blog/" class="active">博客</a></li>
      </ul>
      <ul class="nav-site nav-site-external">
        <li><a href="https://github.com/discountry/react" target="_blank">参与翻译</a></li>
        <li><a href="https://github.com/facebook/react" target="_blank">GitHub</a></li>
        <li><a href="https://github.com/facebook/react/releases" target="_blank">v15.6.1</a></li>
      </ul>
    </div>
  </div>
</div>


    <section class="content wrap blogContent">
  <div class="nav-docs nav-blog">
  <div class="nav-docs-section">
    <h3>近期文章</h3>
    <ul>
      
        <li><a href="/react/blog/2017/09/08/dom-attributes-in-react-16.html">DOM Attributes in React 16</a></li>
      
        <li><a href="/react/blog/2017/07/26/error-handle-in-react-16.html">Error Handle in React 16</a></li>
      
        <li><a href="/react/blog/2017/06/13/react-v15.6.0.html">React v15.6.0</a></li>
      
        <li><a href="/react/blog/2017/04/07/react-v15.5.0.html">React v15.5.0</a></li>
      
        <li><a href="/react/blog/2016/11/16/react-v15.4.0.html">React v15.4.0</a></li>
      
        <li><a href="/react/blog/2016/09/28/our-first-50000-stars.html">Our First 50,000 Stars</a></li>
      
        <li><a href="/react/blog/2016/08/05/relay-state-of-the-state.html">Relay: State of the State</a></li>
      
        <li><a href="/react/blog/2016/07/22/create-apps-with-no-configuration.html">Create Apps with No Configuration</a></li>
      
        <li><a href="/react/blog/2016/07/13/mixins-considered-harmful.html">Mixins Considered Harmful</a></li>
      
        <li><a href="/react/blog/2016/07/11/introducing-reacts-error-code-system.html">Introducing React's Error Code System</a></li>
      
      <li><a href="/react/blog/all.html">All posts ...</a></li>
    </ul>
  </div>
</div>

  <div class="inner-content">
    
      <div class="post-list-item">
        

<h1>

  <a href="/react/blog/2017/09/08/dom-attributes-in-react-16.html">DOM Attributes in React 16</a>

</h1>

<p class="meta">
  September  8, 2017
  by
  
    
      <a href="https://twitter.com/dan_abramov">Dan Abramov</a>
    
    
  
</p>

<hr>

<div class="post">
  <p>过去，React 习惯于忽视未知的 DOM 属性。若你在 JSX 中写了一个 React 无法识别的元素， React 将会忽略他。例如这样：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Your code:</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">mycustomattribute</span><span class="o">=</span><span class="s2">&quot;something&quot;</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>在 React 15 中将会在 DOM 节点中渲染一个空的 div:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="c1">// React 15 output:</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>在 React 16 中，我们做了一些改变。未知特性会在 DOM 节点的末尾：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="c1">// React 16 output:</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">mycustomattribute</span><span class="o">=</span><span class="s2">&quot;something&quot;</span> <span class="o">/&gt;</span>
</code></pre></div>
<h2>为何要改变？</h2>

<p>React 为 DOM 提供了以 JavaScript 为核心的 API。由于 React 组件总是带有自定义以及 DOM 相关的 props，其使得 React 使用小驼峰命名会更易理解，类似于 DOM 的 API：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">tabIndex</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>这并未改变。然而，过去这一方式强制我们在库中维护一个合法的 DOM 元素白名单：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="c1">// ...</span>
<span class="nx">summary</span><span class="o">:</span> <span class="s1">&#39;summary&#39;</span><span class="p">,</span>
<span class="nx">tabIndex</span><span class="o">:</span> <span class="s1">&#39;tabindex&#39;</span>
<span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;target&#39;</span><span class="p">,</span>
<span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;title&#39;</span><span class="p">,</span>
<span class="c1">// ...</span>
</code></pre></div>
<p>这一方是有两个弊端：</p>

<ul>
<li><p>你无法<a href="https://github.com/facebook/react/issues/140">传自定义属性</a>。而这对于未标准化的浏览器相关的属性，尝试新的DOM API以及集成一些独特的第三方库。</p></li>
<li><p>属性列表不断地增长，但 大部分 React 独有的属性命名已在 DOM 中合法。移除白名单的大部分属性能够稍微减少库的大小。</p></li>
</ul>

<p>随着新版本发布，这些问题都将解决。在 React 16 中，你可以传递自定义属性给所有的 HTML 和 SVG 元素，同时 React 也不必在将所有的属性白名单包含进生产版本里。</p>

<p><strong>注意，对于已知属性，你仍需要使用规范的 React 命名。</strong></p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Yes, please</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">tabIndex</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="o">/&gt;</span>

<span class="c1">// Warning: Invalid DOM property `tabindex`. Did you mean `tabIndex`?</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">tabindex</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>换句话说，你在 React 中使用 DOM 组件的方式并没有改变，但现在你有了新方式。</p>

<h2>应该在属性中存储数据？</h2>

<p>不。我们不鼓励奖数据存放在 DOM 属性中。即使你不得不，使用 <code>data-</code>
可能会是更好的方式，但大多数情况下数据应被保存在 React 组件状态或额外存储。</p>

<p>然而，若你需要使用非标准化的或是新的 DOM 属性那新特性将会十分方便，或若你需要与依赖这些新特性的第三方库进行整合。</p>

<h2>Data 和 ARIA 属性</h2>

<p>和之前一样，React 能够让你随意地传递 <code>data-</code> 和 <code>aria-</code>：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">data</span><span class="o">-</span><span class="nx">foo</span><span class="o">=</span><span class="s2">&quot;42&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="nx">button</span> <span class="nx">aria</span><span class="o">-</span><span class="nx">label</span><span class="o">=</span><span class="s2">&quot;Close&quot;</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{</span><span class="nx">onClose</span><span class="p">}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>这并没有改变。</p>

<p><a href="/react/docs/accessibility.html">可访问性</a> 非常重要，因此即使 React 16 能够传递任何属性，其仍然会在开发模式下验证 <code>aria-</code> props 是否正确命名，就像之前 React 15 一样。</p>

<h2>迁移路径</h2>

<p>自一年多前的 <a href="https://github.com/facebook/react/releases/tag/v15.2.0">React 15.2.0</a> 发布，我们已将<a href="/react/warnings/unknown-prop.html">关于未知属性的一个警告</a> 包含在内。大量的第三方库也已进行代码升级。若你的应用在 React 15.2.0 或更高版本中并未产生警告，那么这一改变并不需要修改你应用中的代码。</p>

<p>若你仍意外地传递非 DOM props 到 DOM 组件中，在 React 16 你将会在 DOM 中开始看到这些特性，例如：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">myData</span><span class="o">=</span><span class="s1">&#39;[Object object]&#39;</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>这在一定程度上是安全的（浏览器将会忽略他们）但当你看到他们时，我们建议你修复这些问题。一个潜在的问题是若你传递一个实现了自定义的 <code>toString()</code> 或 <code>valueOf()</code> 方法的对象将会抛出异常。另一个可能的问题是合法的 HTML 元素如 <code>align</code> 和 <code>valign</code> 现在会被传递给 DOM。它们过去则是被忽略，因为React 并不支持它们。</p>

<p>为避免这些问题，在升级到 React 16 之前，我们建议你修复你在 React 15中看到的这些警告。</p>

<h2>变更细节</h2>

<p>我们已做了一些其他调整已让行为能够更加可预测并能致力于让你不犯错。我们无法预期这些改变可能会破坏实际应用。</p>

<p><strong>这些变更仅影响 DOM 组件 如 <code>&lt;div&gt;</code>，而不会影响你自己的组件。</strong></p>

<p>下列是变更的细节。</p>

<ul>
<li><p><strong>带有字符，数字或对象值得未知属性：</strong></p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">mycustomattribute</span><span class="o">=</span><span class="s2">&quot;value&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">mycustomattribute</span><span class="o">=</span><span class="p">{</span><span class="mi">42</span><span class="p">}</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="nx">mycustomattribute</span><span class="o">=</span><span class="p">{</span><span class="nx">myObject</span><span class="p">}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 15：警告并忽略。
React 16：将值转换成字符串并传递给组件。</p>

<p><em>注意：以 <code>on</code> 开始的特性并不会被传递而是抛出异常因为这可能是一个潜在的安全漏洞。</em></p></li>
<li><p><strong>带有不同规范的 React 命名的已知属性：</strong></p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">tabindex</span><span class="o">=</span><span class="s2">&quot;-1&quot;</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="nx">div</span> <span class="kr">class</span><span class="o">=</span><span class="s2">&quot;hi&quot;</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 15：警告并忽略。
React 16：警告但会将其转换为字符串并传递给组件。</p>

<p><em>注意：永远对支持的特性使用规范的 React 命名规则。</em></p></li>
<li><p><strong>带有布尔值的非布尔值特性：</strong></p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="kc">false</span><span class="p">}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 15：将布尔值转换为字符串并传递给组件
React 16：警告并忽略。</p></li>
<li><p><strong>带有函数的非事件特性：</strong></p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="kd">function</span><span class="p">()</span> <span class="p">{}}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 15：将函数转换为字符串并传递给组件。
React 16：警告并忽略。</p></li>
<li><p><strong>带有 Symbol 的属性：</strong></p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="p">{</span><span class="nx">Symbol</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 15：崩溃。
React 16：警告并忽略。</p></li>
<li><p><strong>带有 <code>NaN</code> 值的属性：</strong></p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="o">&lt;</span><span class="nx">div</span> <span class="nx">tabIndex</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span> <span class="o">/</span> <span class="mi">0</span><span class="p">}</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>React 16：将 <code>NaN</code> 转换为字符串并传递给组件。
React 16：警告并忽略。</p></li>
</ul>

<p>随这一测试版的发布，我们也为所有已知元素<a href="https://github.com/facebook/react/blob/master/fixtures/attribute-behavior/AttributeTableSnapshot.md">创建一个自动生成的表单</a>以追踪潜在的问题。</p>

<h2>试一试</h2>

<p>你可以在 <a href="https://codepen.io/gaearon/pen/gxNVdP?editors=0010">CodePen</a> 尝试这些变更。其使用 React 16 RC 版本，你也可以 <a href="https://github.com/facebook/react/issues/10294">在你的项目中帮助我们测试 RC</a>。</p>

<h2>感谢</h2>

<p>这一努力大部分由一位 <a href="https://github.com/nhunzaker">Nathan Hunzaker</a> 所推动， <a href="https://github.com/facebook/react/pulls?q=is%3Apr+author%3Anhunzaker+is%3Aclosed">其是一位高产的 React 外部贡献者</a>。</p>

<p>你可以在过去一年的历程里在下列几个 PR 的这个问题上发现他的工作：
<a href="https://github.com/facebook/react/pull/6459">#6459</a>、<a href="https://github.com/facebook/react/pull/7311">#7311</a>、<a href="https://github.com/facebook/react/pull/10229">#10229</a>、<a href="https://github.com/facebook/react/pull/10397">#10397</a>、<a href="https://github.com/facebook/react/pull/10385">#10385</a> 和 <a href="https://github.com/facebook/react/pull/10470">#10470</a>。</p>

<p>在一个受欢迎的项目中核心的调整需要花费大量时间和研究。Nathan 展示了坚定的决心并承诺完成这一调整，我们非常感谢他的这一工作及其他的贡献。</p>

<p>我们也想要感谢 <a href="https://github.com/aweary">Brandon Dail</a> 和 <a href="https://github.com/jquense">Jason Quense</a> 在这一年中无私地帮助维护 React 项目。</p>

<h2>未来计划</h2>

<p>我们还未调整 <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components/Custom_Elements">自定义元素</a> 如何在 React 16 中工作，但关于设置属性而非特性已经有了一些<a href="https://github.com/facebook/react/issues/7249">讨论</a>，我们可能在 React 17 中在回过头来看看。若你愿意提供帮助，随时都可以来提。</p>

</div>



      </div>
    
      <div class="post-list-item">
        

<h1>

  <a href="/react/blog/2017/07/26/error-handle-in-react-16.html">Error Handle in React 16</a>

</h1>

<p class="meta">
  July 26, 2017
  by
  
    
      
    
    
  
</p>

<hr>

<div class="post">
  <p>随着React 16发布在即，我们打算介绍一些在组件内部React如何处理JavaScript错误。这些改变包含在React 16的beta版本中，并将成为React 16的一部分。</p>

<p><strong>顺便一提，<a href="https://github.com/facebook/react/issues/10294">你可以尝试我们刚发布了React 16的第一个测试版本！</a></strong></p>

<h2>React 15及之前的行为</h2>

<p>过去，组件内部的JavaScript异常曾经常阻断了React内部状态并导致其在下一次渲染时<a href="https://github.com/facebook/react/issues/6895">触发了隐藏的错误</a>。这些错误常常是由应用程序代码中的早期错误所引起的，但React并未提供一种在组件里优雅处理的方式，也不会从异常中回复。</p>

<h2>错误边界介绍</h2>

<p>UI部分的JavaScript异常不应阻断整个应用。为了为React用户解决这一问题，React 16引入了“错误边界（error boundary”）”这一新概念。</p>

<p>错误边界作为React组件，用以<strong>捕获在子组件树种任何地方的JavaScript异常，打印这些错误，并展示备用UI</strong>而非让组件树崩溃。错误边界会捕获渲染期间，在生命周期方法中以及在其整个树的构造函数中的异常。</p>

<p>若定义一个称为<code>componentDidCatch(error, info)</code>的新生命周期方法，则类组件将成为错误边界：</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="kr">class</span> <span class="nx">ErrorBoundary</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">hasError</span><span class="o">:</span> <span class="kc">false</span> <span class="p">};</span>
  <span class="p">}</span>

  <span class="nx">componentDidCatch</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">info</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Display fallback UI</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="nx">hasError</span><span class="o">:</span> <span class="kc">true</span> <span class="p">});</span>
    <span class="c1">// You can also log the error to an error reporting service</span>
    <span class="nx">logErrorToMyService</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">info</span><span class="p">);</span>
  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">hasError</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// You can render any custom fallback UI</span>
      <span class="k">return</span> <span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">Something</span> <span class="nx">went</span> <span class="nx">wrong</span><span class="p">.</span><span class="o">&lt;</span><span class="err">/h1&gt;;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>而后可作为一个正常组件进行使用：</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="o">&lt;</span><span class="nx">ErrorBoundary</span><span class="o">&gt;</span>
  <span class="o">&lt;</span><span class="nx">MyWidget</span> <span class="o">/&gt;</span>
<span class="o">&lt;</span><span class="err">/ErrorBoundary&gt;</span>
</code></pre></div>
<p><code>componentDidCatch()</code>方法的作用类似于JavaScript的<code>catch {}</code>，但仅针对组件。仅有类组件可以成为错误边界。实际上，大多数时间你会想仅声明一次错误边界组件并在整个应用中使用。</p>

<p>注意，<strong>错误边界仅可以捕获树中后代的组件错误</strong>。一个错误边界无法捕获其自身的错误。若错误边界尝试渲染错误信息失败，则该错误会传递至上方最接近的错误边界。而这也类似JavaScript中的<code>catch {}</code>块的工作方式。</p>

<h2>Live Demo</h2>

<p>查看<a href="https://github.com/facebook/react/issues/10294">在React 16测试版</a>中<a href="https://codepen.io/gaearon/pen/wqvxGa?editors=0010">关于如何声明和使用错误边界的例子</a>。</p>

<h2>放置错误边界</h2>

<p>错误边界的粒度完全取决于你。你可能将其包装在顶层路由组件中并为用户展示“内部异常（Something went wrong）”的信息，类似于服务端框架处理崩溃。你可能也会在错误边界包装一些内部组件用以保护不会让应用的余下部分不会崩溃。</p>

<h2>未捕获错误的新行为</h2>

<p>这一改变有一个重要的意义。<strong>作为React 16中不是由错误边界引起的错误将会使得整个React组件树被卸载。</strong></p>

<p>我们曾争论这一决定，但在我们的经验中，将损坏的UI留在那里要比完全移除它要糟糕得多。例如，在类似Messenger这样的产品中留下可见的损坏的UI可能会导致一些人将信息发送给错误的人。类似地，对于支付应用来说显示错误的金额要比什么都不显示糟糕得多。</p>

<p>这一改变意味着随着迁移至React 16，你们将会发现之前未留意过的应用程序存在的崩溃。增加错误边界能够让你在发生异常时提供更好的用户体验。</p>

<p>例如，Facebook Messenger将边栏，信息面板，会话日志以及消息输入的内容包装到单独的错误边界中。若其中某一个组件的UI崩溃了，其余的仍能正常交互。</p>

<p>我们也鼓励你使用JS错误报告服务（或自己构建）以让你能够了解在产品中产生的未处理的异常，并修复它们。</p>

<h2>组件栈追踪</h2>

<p>React 16会打印所有在开发环节中发生在渲染过程的错误到控制台，即使应用程序意外地将他们吞了。除了错误信息和JavaScript堆栈，其还提供了组件栈追踪。闲杂你可以在组件树中精确地查看错误产生的地方：</p>

<p><img src="/react/img/blog/error-boundaries-stack-trace.png" alt="Component stack traces in error message" /></p>

<p>你也可以在组件堆栈中查看文件名和行数。这一功能在<a href="https://github.com/facebookincubator/create-react-app">Create React App 项目</a>中默认开启：</p>

<p><img
src="/react/img/blog/error-boundaries-stack-trace-line-numbers.png" alt="Component stack traces with line numbers in error message" /></p>

<p>若你不使用Create React App，你可以手动添加<a href="https://www.npmjs.com/package/babel-plugin-transform-react-jsx-source">该插件</a> 到你的Babel配置中。注意其仅能在开发环境中使用并<strong>禁止在生产环境中使用。</strong></p>

<h2>为何不使用<code>try</code> / <code>catch</code>？</h2>

<p><code>try</code> / <code>catch</code> 很好但其仅适用于命令式的代码：</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="k">try</span> <span class="p">{</span>
  <span class="nx">showButton</span><span class="p">();</span>
<span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div>
<p>然而，React组件是声明式的，并指定了什么应该被渲染：</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span></span><span class="o">&lt;</span><span class="nx">Button</span> <span class="o">/&gt;</span>
</code></pre></div>
<p>错误边界保留了React声明式的特性，同时其行为和你期望的一直。例如，即使一个在<code>componentDidUpdate</code>周期由组件树内部底层的<code>setState</code>导致的错误，其仍能够正确地传递到最近的错误边界。</p>

<h2>自React 15开始的命名变更</h2>

<p>React 15 在不同的方法名下为错误边界包含了一个非常有限的支持：<code>unstable_handleError</code>。该方法不再生效，同时自React 16第一个测试版本发布开始，你需要在你的代码中将其修改为<code>componentDidCatch</code>。</p>

<p>为应对这一改变，我们已提供了<a href="https://github.com/reactjs/react-codemod#error-boundaries">一份 codemod</a>以用于自动地迁移你的代码。</p>

</div>



      </div>
    
      <div class="post-list-item">
        

<h1>

  <a href="/react/blog/2017/06/13/react-v15.6.0.html">React v15.6.0</a>

</h1>

<p class="meta">
  June 13, 2017
  by
  
    
      
    
    
  
</p>

<hr>

<div class="post">
  <p>今天我们发布了React 15.6.0。由于我们在准备React 16.0，因此我们修复和清理了许多东西。此次发布将继续为后续铺路。</p>

<h2>改进Inputs</h2>

<p>在React 15.6.0，输入框的<code>onChange</code>事件稍微可靠了点并能够处理更多边界条件，涵盖以下：</p>

<ul>
<li>当单选按钮被点击但未改变时事件未触发（<a href="https://github.com/facebook/react/issues/1471">issue 1471</a>）</li>
<li>用方向键（arrow keys）修改<code>范围（range）</code>类型的输入框（<a href="https://github.com/facebook/react/issues/554">issue 554</a>）</li>
<li>在IE 11复制文本到文本框中（<a href="https://github.com/facebook/react/issues/7211">issue 7211</a>）</li>
<li>在IE 11自动填充（<a href="https://github.com/facebook/react/issues/6614">issue 6614</a>）</li>
<li>在IE 11中通过&#39;x&#39;键或右键&#39;删除&#39;清空输入框（<a href="https://github.com/facebook/react/issues/6822">issue 6822</a>）</li>
<li>在IE 11中渲染输入框中已存在字符时事件未触发（<a href="https://github.com/facebook/react/issues/2185">issue 2185</a>）</li>
</ul>

<p>感谢<a href="https://github.com/jquense">Jason Quense</a>以及其他帮助解决上述问题和提出PR的各位。</p>

<h2>更少嘈杂的弃用警告</h2>

<p>我们还为之后的弃用引入了一系列新的警告。这些并不会影响大多数用户，更多细节可以查看下面的修改日志。</p>

<p>自上次发布之后，我们从社区得到了一些有价值的反馈，弃用警告会产生噪音并使得测试失败。<strong>在React 15.6，我们采用<code>console.warn</code>而不是<code>console.error</code>来对弃用警告进行降级处理</strong>。我们的其他警告将仍使用<code>console.error</code>因为他们面对的可能是引发异常的棘手问题。不同于我们其他警告，弃用警告可以延期修复并且不会在发布环节对你的引用造成问题。我们认为降低弃用警告的紧急程度将会让你在下个版本的升级中更为容易。感谢参与这一问题讨论的各位。</p>

<hr>

<h2>安装</h2>

<p>我们推荐使用<a href="https://yarnpkg.com/">Yarn</a>或<a href="https://www.npmjs.com/">npm</a>来管理前端依赖。若你是初次接触包管理器，<a href="https://yarnpkg.com/en/docs/getting-started">Yarn documentation</a>是一个不错的起点。</p>

<p>通过Yarn安装React，运行：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>yarn add react@^15.6.0 react-dom@^15.6.0
</code></pre></div>
<p>通过npm安装React，运行：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>npm install --save react@^15.6.0 react-dom@^15.6.0
</code></pre></div>
<p>我们推荐如<a href="https://webpack.js.org/">webpack</a> 或 <a href="http://browserify.org/">Browserify</a>打包器，以让你可以编写模块化代码并将其打包到一起放在一个小的包内以优化加载时间。</p>

<p>记住默认情况下，React在开发模式下运行会带有额外检查并提供有用的警告。当部署你的应用时，确保其<a href="/react/docs/installation.html#development-and-production-versions">在生产模式编译</a>。</p>

<p>万一你未使用打包器，我们也提供了一个预先构建好的包在npm上，你可以在你的页面中<a href="/react/docs/installation.html#using-a-cdn">通过script标签引入</a>：</p>

<ul>
<li><strong>React</strong><br/>
带警告的开发版本: <a href="https://unpkg.com/react@15.6.0/dist/react.js">react/dist/react.js</a><br/>
用于生产的压缩版本: <a href="https://unpkg.com/react@15.6.0/dist/react.min.js">react/dist/react.min.js</a><br/></li>
<li><strong>React with Add-Ons</strong><br/>
带警告的开发版本: <a href="https://unpkg.com/react@15.6.0/dist/react-with-addons.js">react/dist/react-with-addons.js</a><br/>
用于生产的压缩版本: <a href="https://unpkg.com/react@15.5.0/dist/react-with-addons.min.js">react/dist/react-with-addons.min.js</a><br/></li>
<li><strong>React DOM</strong> (页面中在React DOM之前引入React) <br/>
带警告的开发版本: <a href="https://unpkg.com/react-dom@15.6.0/dist/react-dom.js">react-dom/dist/react-dom.js</a><br/>
用于生产的压缩版本: <a href="https://unpkg.com/react-dom@15.6.0/dist/react-dom.min.js">react-dom/dist/react-dom.min.js</a><br/></li>
<li><strong>React DOM Server</strong> (页面中在React DOM Server之前引入React)<br/>
带警告的开发版本: <a href="https://unpkg.com/react-dom@15.6.0/dist/react-dom-server.js">react-dom/dist/react-dom-server.js</a><br/>
用于生产的压缩版本: <a href="https://unpkg.com/react-dom@15.6.0/dist/react-dom-server.min.js">react-dom/dist/react-dom-server.min.js</a><br/></li>
</ul>

<p>我们还在npm上发布了<code>react</code>，<code>react-dom</code>及附件包的<code>15.5.0</code>版本以及在bower上的<code>react</code>包。</p>

<hr>

<h2>修改日志</h2>

<h2>15.6.0 (June 13, 2017)</h2>

<h3>React</h3>

<ul>
<li>采用<code>console.warn</code>而不是<code>console.error</code>来降级处理弃用警告。(<a href="https://github.com/flarnie">@flarnie</a> 在 <a href="https://github.com/facebook/react/pull/9753">#9753</a> 的提交)</li>
<li>为<code>React.createClass</code>增加弃用警告。将用户指向<code>create-react-class</code>。(<a href="https://github.com/flarnie">@flarnie</a> 在 <a href="https://github.com/facebook/react/pull/9771">#9771</a> 的提交)</li>
<li>增加弃用警告并为<code>React.DOM</code>工厂辅助方法分离为新模块。(<a href="https://github.com/nhunzaker">@nhunzaker</a> 在 <a href="https://github.com/facebook/react/pull/8356">#8356</a> 的提交)</li>
<li><code>React.createMixin</code>的弃用警告辅助方法将不再使用。(<a href="https://github.com/aweary">@aweary</a> 在 <a href="https://github.com/facebook/react/pull/8853">#8853</a> 的提交)</li>
</ul>

<h3>React DOM</h3>

<ul>
<li>在<code>style</code>属性中增加CSS变量支持。 (<a href="https://github.com/aweary">@aweary</a> 在 <a href="https://github.com/facebook/react/pull/9302">#9302</a> 的提交)</li>
<li>增加CSS网格(Grid)样式属性支持。(<a href="https://github.com/ericsakmar">@ericsakmar</a> 在 <a href="https://github.com/facebook/react/pull/9185">#9185</a> 的提交)</li>
<li>修复输入框改变可变值类型异常。(<a href="https://github.com/mhunzaker">@nhunzaker</a> 在 <a href="https://github.com/facebook/react/pull/9806">#9806</a> 的提交)</li>
<li>修复在某些输入场景下<code>onChange</code>未触发的问题。(<a href="https://github.com/jquense">@jquense</a> 在 <a href="https://github.com/facebook/react/pull/8575">#8575</a> 的提交)</li>
<li>修复控制数字输入框错误允许期间的异常。(<a href="https://github.com/nhunzaker">@nhunzaker</a> 在 <a href="https://github.com/facebook/react/pull/9584">#9584</a> 的提交)</li>
<li>修复性能记录(performance entry)被清除的bug。(<a href="https://github.com/chrisui">@chrisui</a> 在 <a href="https://github.com/facebook/react/pull/9451">#9451</a> 的提交)</li>
</ul>

</div>



      </div>
    
      <div class="post-list-item">
        

<h1>

  <a href="/react/blog/2017/04/07/react-v15.5.0.html">React v15.5.0</a>

</h1>

<p class="meta">
  April  7, 2017
  by
  
    
      <a href="https://twitter.com/acdlite">Andrew Clark</a>
    
    
  
</p>

<hr>

<div class="post">
  <p>自上次更新React已经是一年前了。我们下一次的重要发布，React 16，将包含一些让人兴奋的提升，包含一个<a href="https://www.youtube.com/watch?v=ZCuYPiUIONs">完全重写</a>的React内核。<a href="/react/contributing/design-principles.html#stability">我们认真考虑了稳定性</a>，并致力于以最小的改动将这些特性带给我们的用户。</p>

<p>最后，我们发布了React 15.5.0。</p>

<h3>新的弃用警告</h3>

<p>最大的改变是我们将<code>React.PropTypes</code>和<code>React.createClass</code> 移到他们的自己的包。二者仍然可以通过主要的<code>React</code>独享访问，但是在开发模式下，使用其中的一个将在控制台上打印一个过时的弃用警告。这将会让之后代码大小有所优化。</p>

<p>这些警告并不会影响你的应用行为。然而，我们意识到他们可能会造成一些困惑，尤其是你使用的测试框架将<code>console.error</code>视为失败时。</p>

<p><strong>添加新警告并不是我们轻易做的。</strong> 警告在React中不仅仅是建议 - 它们是我们能够让尽可能多地人使用最新版React的策略的组成部分。我们从不在不增加路径的情况下增加警告。</p>

<p>因此，当警告可能在短期内造成困惑，我们相信<strong>能刺激开发者在当前迁移代码库而防止在未来产生更大困惑</strong>。提前修复警告确保你已为下一个重要发布做好了准备。若你的应用在15.5时产生了0个警告，那么在16中应该能够继续工作而无需任何改变。</p>

<p>关于每一项新的弃用，我们已经提供了一份代码修改（codemod）以自动迁移你的代码。它们已可以利用来作为 <a href="https://github.com/reactjs/react-codemod">react-codemod</a>项目的部分。</p>

<h3>从React.PropTypes迁移</h3>

<p>属性类型是用于在开发期间对属性进行运行时校验的一项特性。我们已将内建的属性类型提取到一个独立的包中以反映是否并非每个人都会使用的事实。</p>

<p>在15.5中，不再是从<code>React</code>主对象中访问 <code>PropTypes</code> ，而是安装<code>prop-types</code>包并从中引入他们：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Before (15.4 and below)</span>
<span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">Component</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">Component</span><span class="p">.</span><span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
<span class="hll">  <span class="nx">text</span><span class="o">:</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
</span><span class="p">}</span>

<span class="c1">// After (15.5)</span>
<span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="hll"><span class="kr">import</span> <span class="nx">PropTypes</span> <span class="nx">from</span> <span class="s1">&#39;prop-types&#39;</span><span class="p">;</span>
</span>
<span class="kr">class</span> <span class="nx">Component</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">div</span><span class="o">&gt;</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/div&gt;;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">Component</span><span class="p">.</span><span class="nx">propTypes</span> <span class="o">=</span> <span class="p">{</span>
<span class="hll">  <span class="nx">text</span><span class="o">:</span> <span class="nx">PropTypes</span><span class="p">.</span><span class="nx">string</span><span class="p">.</span><span class="nx">isRequired</span><span class="p">,</span>
</span><span class="p">};</span>
</code></pre></div>
<p>对于这一改变，<a href="https://github.com/reactjs/react-codemod#react-proptypes-to-prop-types">codemo</a> 自动处理这一转换。基础用法：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>jscodeshift -t react-codemod/transforms/React-PropTypes-to-prop-types.js &lt;path&gt;
</code></pre></div>
<p><code>propTypes</code>， <code>contextTypes</code> 和 <code>childContextTypes</code>仍将和以前一样。唯一的改变是以前内建的的验证器现在位于独立的包内。</p>

<p>你也可能考虑使用 <a href="https://flow.org/">Flow</a>来静态地检查你的JavaScript代码类型，包括<a href="https://flow.org/en/docs/frameworks/react/#setup-flow-with-react-a-classtoc-idtoc-setup-flow-with-react-hreftoc-setup-flow-with-reacta">React 组件</a>.</p>

<h3>从React.crateClass迁移</h3>

<p>当React首次发布时，在JavaScript中并没有通用的方式创建类，因此我们提供我们一个自定义方法：<code>React.createClass</code>。</p>

<p>而后，类被添加进该语言中作为ES2015的一部分，因此我们增加了使用JavaScript的类来创建React组件的能力。<strong>与函数式组件一起，JavaScript类现在都是<a href="/react/docs/components-and-props.html#functional-and-class-components">在React创建组件的首选方式</a>。</strong></p>

<p>对于已经存在的 <code>createClass</code> 组件，我们建议你将它们迁移到JavaScript类。然而，若你的组件依赖于混合（mixins），迁移至类可能不会立即可行。若是如此，<code>create-react-class</code> 作为一个顺带的替换方案已在npm上可用：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Before (15.4 and below)</span>
<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react&#39;</span><span class="p">);</span>

<span class="hll"><span class="kd">var</span> <span class="nx">Component</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
</span>  <span class="nx">mixins</span><span class="o">:</span> <span class="p">[</span><span class="nx">MixinA</span><span class="p">],</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">Child</span> <span class="o">/&gt;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// After (15.5)</span>
<span class="kd">var</span> <span class="nx">React</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;react&#39;</span><span class="p">);</span>
<span class="hll"><span class="kd">var</span> <span class="nx">createReactClass</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;create-react-class&#39;</span><span class="p">);</span>
</span>
<span class="hll"><span class="kd">var</span> <span class="nx">Component</span> <span class="o">=</span> <span class="nx">createReactClass</span><span class="p">({</span>
</span>  <span class="nx">mixins</span><span class="o">:</span> <span class="p">[</span><span class="nx">MixinA</span><span class="p">],</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="o">&lt;</span><span class="nx">Child</span> <span class="o">/&gt;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p>你的组件仍然能够和之前一样继续工作。</p>

<p>对于这一变化，<a href="https://github.com/reactjs/react-codemod#explanation-of-the-new-es2015-class-transform-with-property-initializers">codemo</a> 尝试转换<code>createClass</code>组件为一个JavaScript类，并在必要时回退到<code>create-react-class</code>。该方案已处理了Facebook内部数千计的组件。</p>

<p>基本用法：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>jscodeshift -t react-codemod/transforms/class.js path/to/components
</code></pre></div>
<h3>不再支持的React附件</h3>

<p>我们将停止维护React附件包。真实地，大多数包已经有很长时间没有维护了。它们仍将持续继续工作，但我们建议尽快迁移以防止将来的破坏。</p>

<ul>
<li><strong>react-addons-create-fragment</strong> - React 16将优先支持碎片，在这点上该包已不再必要。我们推荐使用键控元素的数组。</li>
<li><strong>react-addons-css-transition-group</strong>。使用<a href="https://github.com/reactjs/react-transition-group">react-transition-group/CSSTransitionGroup</a>。1.1.1版本提供了插入式的替代方案。</li>
<li><strong>react-addons-linked-state-mixin</strong> 直接设置<code>value</code>和<code>onChange</code>处理器</li>
<li><strong>react-addons-pure-render-mixin</strong> - 使用<a href="/react/docs/react-api.html#react.purecomponent"><code>React.PureComponent</code></a>。</li>
<li><strong>react-addons-shallow-compare</strong> - 使用<a href="/react/docs/react-api.html#react.purecomponent"><code>React.PureComponent</code></a>。</li>
<li><strong>react-addons-transition-group</strong> 使用<a href="https://github.com/reactjs/react-transition-group">react-transition-group/TransitionGroup</a>。1.1.1版本提供了一个插入式的替代方案。</li>
<li><strong>react-addons-update</strong> - 使用<a href="https://github.com/kolodny/immutability-helper">immutability-helper</a>，一个插入式替代方案。</li>
<li><strong>react-linked-input</strong> - 直接设置<code>value</code>和<code>onChange</code>处理器。</li>
</ul>

<p>我们也放弃对于<code>react-with-addons</code>UMD构建的支持。其将在React 16中被移除。</p>

<h3>React测试套件</h3>

<p>当前，React 测试套件位于<code>react-addons-test-utils</code>内。在15.5中，我们将其从包中独立出去，并将它们迁移至<code>react-dom/test-utils</code>：</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Before (15.4 and below)</span>
<span class="kr">import</span> <span class="nx">TestUtils</span> <span class="nx">from</span> <span class="s1">&#39;react-addons-test-utils&#39;</span><span class="p">;</span>

<span class="c1">// After (15.5)</span>
<span class="kr">import</span> <span class="nx">TestUtils</span> <span class="nx">from</span> <span class="s1">&#39;react-dom/test-utils&#39;</span><span class="p">;</span>
</code></pre></div>
<p>这反应了我们所说的测试套件实际上是一套包装了DOM渲染器的API。</p>

<p>浅渲染是一个例外，其并不是DOM规范。浅渲染器已被移至<code>react-test-renderer/shallow</code>。</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Before (15.4 and below)</span>
<span class="hll"><span class="kr">import</span> <span class="p">{</span> <span class="nx">createRenderer</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-addons-test-utils&#39;</span><span class="p">;</span>
</span>
<span class="c1">// After (15.5)</span>
<span class="hll"><span class="kr">import</span> <span class="p">{</span> <span class="nx">createRenderer</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">&#39;react-test-renderer/shallow&#39;</span><span class="p">;</span>
</span></code></pre></div>
<hr>

<h2>感谢</h2>

<p>特别感谢这些人转让npm包名称的所有权：</p>

<ul>
<li><a href="https://github.com/developit">Jason Miller</a></li>
<li><a href="https://github.com/aackerman">Aaron Ackerman</a></li>
<li><a href="https://github.com/viniciusmarson">Vinicius Marson</a></li>
</ul>

<hr>

<h2>安装</h2>

<p>我们推荐使用<a href="https://yarnpkg.com/">Yarn</a>或<a href="https://www.npmjs.com/">npm</a>来管理前端依赖。若你是初次接触包管理器，<a href="https://yarnpkg.com/en/docs/getting-started">Yarn documentation</a>是一个不错的起点。</p>

<p>通过Yarn安装React，运行：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>yarn add react@^15.5.0 react-dom@^15.5.0
</code></pre></div>
<p>通过npm安装React，运行：</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>npm install --save react@^15.5.0 react-dom@^15.5.0
</code></pre></div>
<p>我们推荐如<a href="https://webpack.js.org/">webpack</a> 或 <a href="http://browserify.org/">Browserify</a>打包器，以让你可以编写模块化代码并将其打包到一起放在一个小的包内以优化加载时间。</p>

<p>记住默认情况下，React在开发模式下运行会带有额外检查并提供有用的警告。当部署你的应用时，确保其<a href="/react/docs/installation.html#development-and-production-versions">在生产模式编译</a>。</p>

<p>万一你未使用打包器，我们也提供了一个预先构建好的包在npm上，你可以在你的页面中<a href="/react/docs/installation.html#using-a-cdn">通过script标签引入</a>。</p>

<ul>
<li><strong>React</strong><br>
带警告的开发版本：<a href="https://unpkg.com/react@15.5.0/dist/react.js">react/dist/react.js</a><br>
用于生产的压缩版本：<a href="https://unpkg.com/react@15.5.0/dist/react.min.js">react/dist/react.min.js</a><br></li>
<li><strong>React with Add-Ons</strong><br>
带警告的开发版本：<a href="https://unpkg.com/react@15.5.0/dist/react-with-addons.js">react/dist/react-with-addons.js</a><br>
用于生产的压缩版本：<a href="https://unpkg.com/react@15.5.0/dist/react-with-addons.min.js">react/dist/react-with-addons.min.js</a><br></li>
<li><strong>React DOM</strong> (在React DOM之前引入React)<br>
带警告的开发版本：<a href="https://unpkg.com/react-dom@15.5.0/dist/react-dom.js">react-dom/dist/react-dom.js</a><br>
用于生产的压缩版本：<a href="https://unpkg.com/react-dom@15.5.0/dist/react-dom.min.js">react-dom/dist/react-dom.min.js</a><br></li>
<li><strong>React DOM Server</strong> (React DOM Server之前引入React)<br>
带警告的开发版本：<a href="https://unpkg.com/react-dom@15.5.0/dist/react-dom-server.js">react-dom/dist/react-dom-server.js</a><br>
用于生产的压缩版本：<a href="https://unpkg.com/react-dom@15.5.0/dist/react-dom-server.min.js">react-dom/dist/react-dom-server.min.js</a></li>
</ul>

<p>我们还在npm上发布了<code>react</code>，<code>react-dom</code>及附件包的<code>15.5.0</code>版本以及在bower上的<code>react</code>包。</p>

<hr>

<h2>修改日志</h2>

<h2>15.5.0 (April 7, 2017)</h2>

<h3>React</h3>

<ul>
<li>为<code>React.createClass</code>增加一个独立的警告。将用户指向create-react-class。（<a href="https://github.com/acdlite">@acdlite</a> 在 <a href="https://github.com/facebook/react/commit/d9a4fa4f51c6da895e1655f32255cf72c0fe620e">d9a4fa4</a>的提交）</li>
<li>为<code>React.PropTypes</code>增加一个独立的警告。将用户指向prop-types。（<a href="https://github.com/acdlite">@acdlite</a> 在 <a href="https://github.com/facebook/react/commit/043845ce75ea0812286bbbd9d34994bb7e01eb28">043845c</a>的提交）</li>
<li>修复同时使用<code>ReactDOM</code>和<code>ReactDOMServer</code>。（<a href="https://github.com/wacii">@wacii</a> 在 <a href="https://github.com/facebook/react/pull/9005">#9005</a>提的PR）</li>
<li>修复关于Closure Compiler的问题。（<a href="https://github.com/Shastel">@Shastel</a> 在 <a href="https://github.com/facebook/react/pull/8882">#8882</a>提的PR）</li>
<li>另一个关于Closure Compiler的修复。（<a href="https://github.com/Shastel">@Shastel</a> 在 <a href="https://github.com/facebook/react/pull/8882">#8882</a>提的PR）</li>
<li>为无效的元素类型警告增加组件栈信息。（<a href="https://github.com/n3tr">@n3tr</a> 在 <a href="https://github.com/facebook/react/pull/8495">#8495</a>提的PR）</li>
</ul>

<h3>React DOM</h3>

<ul>
<li>修正当在数字输入中回退时的Chrome bug。(<a href="https://github.com/nhunzaker">@nhunzaker</a> 在 <a href="https://github.com/facebook/react/pull/7359">#7359</a>提的PR)</li>
<li>增加<code>react-dom/test-utils</code>，暴露React测试套件。(<a href="https://github.com/bvaughn">@bvaughn</a>)</li>
</ul>

<h3>React Test Renderer</h3>

<ul>
<li>修复子组件不会调用<code>componentWillUnmount</code>。（<a href="https://github.com/gre">@gre</a> 在 [#8512](https://github.com/facebook/react/pull/8512]提的PR）</li>
<li>增加 <code>react-test-renderer/shallow</code>，暴露浅渲染器。</li>
</ul>

<h3>React Addons</h3>

<ul>
<li>最后一次发布附件；他们将不再被维护</li>
<li>移除<code>peerDependencies</code>以让附件能够无限期继续工作。（<a href="https://github.com/acdlite">@acdlite</a> 和 <a href="https://github.com/bvaughn">@bvaughn</a> 在 <a href="https://github.com/facebook/react/commit/8a06cd7a786822fce229197cac8125a551e8abfa">8a06cd7</a> 和 <a href="https://github.com/facebook/react/commit/67a8db3650d724a51e70be130e9008806402678a">67a8db3</a>的提交）</li>
<li>更新以移除<code>React.createClass</code> 和 <code>React.PropTypes</code> 的引用。（<a href="https://github.com/acdlite">@acdlite</a> 在 <a href="https://github.com/facebook/react/commit/12a96b94823d6b6de6b1ac13bd576864abd50175">12a96b9</a>的提交）</li>
<li><code>react-addons-test-utils</code>被移除。使用<code>react-dom/test-utils</code> 和 <code>react-test-renderer/shallow</code> 代替。（<a href="https://github.com/bvaughn">@bvaughn</a>）</li>
</ul>

</div>



      </div>
    
      <div class="post-list-item">
        

<h1>

  <a href="/react/blog/2016/11/16/react-v15.4.0.html">React v15.4.0</a>

</h1>

<p class="meta">
  November 16, 2016
  by
  
    
      <a href="https://twitter.com/dan_abramov">Dan Abramov</a>
    
    
  
</p>

<hr>

<div class="post">
  <p>Today we are releasing React 15.4.0.</p>

<p>We didn&#39;t announce the <a href="https://github.com/facebook/react/blob/master/CHANGELOG.md#1510-may-20-2016">previous</a> <a href="https://github.com/facebook/react/blob/master/CHANGELOG.md#1520-july-1-2016">minor</a> <a href="https://github.com/facebook/react/blob/master/CHANGELOG.md#1530-july-29-2016">releases</a> on the blog because most of the changes were bug fixes. However, 15.4.0 is a special release, and we would like to highlight a few notable changes in it.</p>

<h3>Separating React and React DOM</h3>

<p><a href="/react/blog/2015/09/10/react-v0.14-rc1.html#two-packages-react-and-react-dom">More than a year ago</a>, we started separating React and React DOM into separate packages. We deprecated <code>React.render()</code> in favor of <code>ReactDOM.render()</code> in React 0.14, and removed DOM-specific APIs from <code>React</code> completely in React 15. However, the React DOM implementation still <a href="https://www.reddit.com/r/javascript/comments/3m6wyu/found_this_line_in_the_react_codebase_made_me/cvcyo4a/">secretly lived inside the React package</a>.</p>

<p>In React 15.4.0, we are finally moving React DOM implementation to the React DOM package. The React package will now contain only the renderer-agnostic code such as <code>React.Component</code> and <code>React.createElement()</code>.</p>

<p>This solves a few long-standing issues, such as <a href="https://github.com/facebook/react/issues/7386">errors</a> when you import React DOM in the same file as the <a href="https://facebook.github.io/jest/blog/2016/07/27/jest-14.html">snapshot testing</a> renderer.</p>

<p><strong>If you only use the official and documented React APIs you won&#39;t need to change anything in your application.</strong></p>

<p>However, there is a possibility that you imported private APIs from <code>react/lib/*</code>, or that a package you rely on might use them. We would like to remind you that this was never supported, and that your apps should not rely on internal APIs. The React internals will keep changing as we work to make React better.</p>

<p>Another thing to watch out for is that React DOM Server is now about the same size as React DOM since it contains its own copy of the React reconciler. We don&#39;t recommend using React DOM Server on the client in most cases.</p>

<h3>Profiling Components with Chrome Timeline</h3>

<p>You can now visualize React components in the Chrome Timeline. This lets you see which components exactly get mounted, updated, and unmounted, how much time they take relative to each other.</p>

<p><center><img src="/react/img/blog/react-perf-chrome-timeline.png" width="651" height="228" alt="React components in Chrome timeline" /></center></p>

<p>To use it:</p>

<ol>
<li><p>Load your app with <code>?react_perf</code> in the query string (for example, <code>http://localhost:3000/?react_perf</code>).</p></li>
<li><p>Open the Chrome DevTools <strong>Timeline</strong> tab and press <strong>Record</strong>.</p></li>
<li><p>Perform the actions you want to profile. Don&#39;t record more than 20 seconds or Chrome might hang.</p></li>
<li><p>Stop recording.</p></li>
<li><p>React events will be grouped under the <strong>User Timing</strong> label.</p></li>
</ol>

<p>Note that the numbers are relative so components will render faster in production. Still, this should help you realize when unrelated UI gets updated by mistake, and how deep and how often your UI updates occur.</p>

<p>Currently Chrome, Edge, and IE are the only browsers supporting this feature, but we use the standard <a href="https://developer.mozilla.org/en-US/docs/Web/API/User_Timing_API">User Timing API</a> so we expect more browsers to add support for it.</p>

<h3>Mocking Refs for Snapshot Testing</h3>

<p>If you&#39;re using Jest <a href="https://facebook.github.io/jest/blog/2016/07/27/jest-14.html">snapshot testing</a>, you might have had <a href="https://github.com/facebook/react/issues/7371">issues</a> with components that rely on refs. With React 15.4.0, we introduce a way to provide mock refs to the test renderer. For example, consider this component using a ref in <code>componentDidMount</code>:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">MyInput</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
<span class="hll">    <span class="k">this</span><span class="p">.</span><span class="nx">input</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
</span>  <span class="p">}</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">input</span>
<span class="hll">        <span class="nx">ref</span><span class="o">=</span><span class="p">{</span><span class="nx">node</span> <span class="o">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">input</span> <span class="o">=</span> <span class="nx">node</span><span class="p">}</span>
</span>      <span class="o">/&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>With snapshot renderer, <code>this.input</code> will be <code>null</code> because there is no DOM. React 15.4.0 lets us avoid such crashes by passing a custom <code>createNodeMock</code> function to the snapshot renderer in an <code>options</code> argument:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span></span><span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">MyInput</span> <span class="nx">from</span> <span class="s1">&#39;./MyInput&#39;</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">renderer</span> <span class="nx">from</span> <span class="s1">&#39;react-test-renderer&#39;</span><span class="p">;</span>

<span class="hll"><span class="kd">function</span> <span class="nx">createNodeMock</span><span class="p">(</span><span class="nx">element</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">  <span class="k">if</span> <span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;input&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">    <span class="k">return</span> <span class="p">{</span>
</span><span class="hll">      <span class="nx">focus</span><span class="p">()</span> <span class="p">{},</span>
</span><span class="hll">    <span class="p">};</span>
</span><span class="hll">  <span class="p">}</span>
</span><span class="hll">  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
</span><span class="hll"><span class="p">}</span>
</span>
<span class="nx">it</span><span class="p">(</span><span class="s1">&#39;renders correctly&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span><span class="nx">createNodeMock</span><span class="p">};</span>
<span class="hll">  <span class="kr">const</span> <span class="nx">tree</span> <span class="o">=</span> <span class="nx">renderer</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">MyInput</span> <span class="o">/&gt;</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</span>  <span class="nx">expect</span><span class="p">(</span><span class="nx">tree</span><span class="p">).</span><span class="nx">toMatchSnapshot</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>
<p>We would like to thank <a href="https://github.com/Aweary">Brandon Dail</a> for implementing this feature.</p>

<p>You can learn more about snapshot testing in <a href="https://facebook.github.io/jest/blog/2016/07/27/jest-14.html">this Jest blog post</a>.</p>

<hr>

<h2>Installation</h2>

<p>We recommend using <a href="https://yarnpkg.com/">Yarn</a> or <a href="https://www.npmjs.com/">npm</a> for managing front-end dependencies. If you&#39;re new to package managers, the <a href="https://yarnpkg.com/en/docs/getting-started">Yarn documentation</a> is a good place to get started.</p>

<p>To install React with Yarn, run:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>yarn add react@15.4.0 react-dom@15.4.0
</code></pre></div>
<p>To install React with npm, run:</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span></span>npm install --save react@15.4.0 react-dom@15.4.0
</code></pre></div>
<p>We recommend using a bundler like <a href="https://webpack.js.org/">webpack</a> or <a href="http://browserify.org/">Browserify</a> so you can write modular code and bundle it together into small packages to optimize load time.</p>

<p>Remember that by default, React runs extra checks and provides helpful warnings in development mode. When deploying your app, make sure to <a href="/react/docs/installation.html#development-and-production-versions">compile it in production mode</a>.</p>

<p>In case you don&#39;t use a bundler, we also provide pre-built bundles in the npm packages which you can <a href="/react/docs/installation.html#using-a-cdn">include as script tags</a> on your page:</p>

<ul>
<li><strong>React</strong><br>
Dev build with warnings: <a href="https://unpkg.com/react@15.4.0/dist/react.js">react/dist/react.js</a><br>
Minified build for production: <a href="https://unpkg.com/react@15.4.0/dist/react.min.js">react/dist/react.min.js</a><br></li>
<li><strong>React with Add-Ons</strong><br>
Dev build with warnings: <a href="https://unpkg.com/react@15.4.0/dist/react-with-addons.js">react/dist/react-with-addons.js</a><br>
Minified build for production: <a href="https://unpkg.com/react@15.4.0/dist/react-with-addons.min.js">react/dist/react-with-addons.min.js</a><br></li>
<li><strong>React DOM</strong> (include React in the page before React DOM)<br>
Dev build with warnings: <a href="https://unpkg.com/react-dom@15.4.0/dist/react-dom.js">react-dom/dist/react-dom.js</a><br>
Minified build for production: <a href="https://unpkg.com/react-dom@15.4.0/dist/react-dom.min.js">react-dom/dist/react-dom.min.js</a><br></li>
<li><strong>React DOM Server</strong> (include React in the page before React DOM Server)<br>
Dev build with warnings: <a href="https://unpkg.com/react-dom@15.4.0/dist/react-dom-server.js">react-dom/dist/react-dom-server.js</a><br>
Minified build for production: <a href="https://unpkg.com/react-dom@15.4.0/dist/react-dom-server.min.js">react-dom/dist/react-dom-server.min.js</a></li>
</ul>

<p>We&#39;ve also published version <code>15.4.0</code> of the <code>react</code>, <code>react-dom</code>, and addons packages on npm and the <code>react</code> package on bower.</p>

<hr>

<h2>Changelog</h2>

<h3>React</h3>

<ul>
<li>React package and browser build no longer &quot;secretly&quot; includes React DOM.<br>
<small>(<a href="https://github.com/sebmarkbage">@sebmarkbage</a> in <a href="https://github.com/facebook/react/pull/7164">#7164</a> and <a href="https://github.com/facebook/react/pull/7168">#7168</a>)</small></li>
<li>Required PropTypes now fail with specific messages for null and undefined.<br>
<small>(<a href="https://github.com/chenglou">@chenglou</a> in <a href="https://github.com/facebook/react/pull/7291">#7291</a>)</small></li>
<li>Improved development performance by freezing children instead of copying.<br>
<small>(<a href="https://github.com/keyanzhang">@keyanzhang</a> in <a href="https://github.com/facebook/react/pull/7455">#7455</a>)</small></li>
</ul>

<h3>React DOM</h3>

<ul>
<li>Fixed occasional test failures when React DOM is used together with shallow renderer.<br>
<small>(<a href="https://github.com/goatslacker">@goatslacker</a> in <a href="https://github.com/facebook/react/pull/8097">#8097</a>)</small></li>
<li>Added a warning for invalid <code>aria-</code> attributes.<br>
<small>(<a href="https://github.com/jessebeach">@jessebeach</a> in <a href="https://github.com/facebook/react/pull/7744">#7744</a>)</small></li>
<li>Added a warning for using <code>autofocus</code> rather than <code>autoFocus</code>.<br>
<small>(<a href="https://github.com/hkal">@hkal</a> in <a href="https://github.com/facebook/react/pull/7694">#7694</a>)</small></li>
<li>Removed an unnecessary warning about polyfilling <code>String.prototype.split</code>.<br>
<small>(<a href="https://github.com/nhunzaker">@nhunzaker</a> in <a href="https://github.com/facebook/react/pull/7629">#7629</a>)</small></li>
<li>Clarified the warning about not calling PropTypes manually.<br>
<small>(<a href="https://github.com/jedwards1211">@jedwards1211</a> in <a href="https://github.com/facebook/react/pull/7777">#7777</a>)</small></li>
<li>The unstable <code>batchedUpdates</code> API now passes the wrapped function&#39;s return value through.<br>
<small>(<a href="https://github.com/bgnorlov">@bgnorlov</a> in <a href="https://github.com/facebook/react/pull/7444">#7444</a>)</small></li>
<li>Fixed a bug with updating text in IE 8.<br>
<small>(<a href="https://github.com/mnpenner">@mnpenner</a> in <a href="https://github.com/facebook/react/pull/7832">#7832</a>)</small></li>
</ul>

<h3>React Perf</h3>

<ul>
<li>When ReactPerf is started, you can now view the relative time spent in components as a chart in Chrome Timeline.<br>
<small>(<a href="https://github.com/gaearon">@gaearon</a> in <a href="https://github.com/facebook/react/pull/7549">#7549</a>)</small></li>
</ul>

<h3>React Test Utils</h3>

<ul>
<li>If you call <code>Simulate.click()</code> on a <code>&lt;input disabled onClick={foo} /&gt;</code> then <code>foo</code> will get called whereas it didn&#39;t before.<br>
<small>(<a href="https://github.com/nhunzaker">@nhunzaker</a> in <a href="https://github.com/facebook/react/pull/7642">#7642</a>)</small></li>
</ul>

<h3>React Test Renderer</h3>

<ul>
<li>Due to packaging changes, it no longer crashes when imported together with React DOM in the same file.<br>
<small>(<a href="https://github.com/sebmarkbage">@sebmarkbage</a> in <a href="https://github.com/facebook/react/pull/7164">#7164</a> and <a href="https://github.com/facebook/react/pull/7168">#7168</a>)</small></li>
<li><code>ReactTestRenderer.create()</code> now accepts <code>{createNodeMock: element =&gt; mock}</code> as an optional argument so you can mock refs with snapshot testing.<br>
<small>(<a href="https://github.com/Aweary">@Aweary</a> in <a href="https://github.com/facebook/react/pull/7649">#7649</a> and <a href="https://github.com/facebook/react/pull/8261">#8261</a>)</small></li>
</ul>

</div>



      </div>
    

    <div class="pagination">
      
      
        <a href="/react/blog/page2/" class="next">
          Next Page &raquo;
        </a>
      
    </div>
  </div>
</section>


    <footer class="nav-footer">
  <section class="sitemap">
    <a href="/react/" class="nav-home">
    </a>
    <div>
      <h5><a href="/react/docs/">文档</a></h5>
      <a href="/react/docs/hello-world.html">快速开始</a>
      <a href="/react/docs/thinking-in-react.html">React 理念</a>
      <a href="/react/tutorial/tutorial.html">上手教程</a>
      <a href="/react/docs/jsx-in-depth.html">高级指引</a>
    </div>
    <div>
      <h5><a href="/react/community/support.html">社区</a></h5>
      <a href="http://stackoverflow.com/questions/tagged/reactjs" target="_blank">Stack Overflow</a>
      <a href="https://discuss.reactjs.org/" target="_blank">论坛</a>
      <a href="https://discord.gg/0ZcbPKXt5bZjGY5n" target="_blank">Reactiflux Chat</a>
      <a href="https://www.facebook.com/react" target="_blank">Facebook</a>
      <a href="https://twitter.com/reactjs" target="_blank">Twitter</a>
    </div>
    <div>
      <h5><a href="/react/community/support.html">资源</a></h5>
      <a href="/react/community/conferences.html">讨论会</a>
      <a href="/react/community/videos.html">视频</a>
      <a href="https://github.com/facebook/react/wiki/Examples" target="_blank">示例</a>
      <a href="https://github.com/facebook/react/wiki/Complementary-Tools" target="_blank">开发工具</a>
    </div>
    <div>
      <h5>更多</h5>
      <a href="/react/blog/">博客</a>
      <a href="https://github.com/facebook/react" target="_blank">GitHub</a>
      <a href="http://facebook.github.io/react-native/" target="_blank">React Native</a>
      <a href="/react/acknowledgements.html">致谢</a>
    </div>
  </section>
  <a href="https://code.facebook.com/projects/" target="_blank" class="fbOpenSource">
    <img src="/react/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/>
  </a>
  <section class="copyright">
    Copyright © 2017 Facebook Inc.
      <br />
    <a href="https://zhuanlan.zhihu.com/icode" target="_blank">从零学习前端开发翻译组</a> | <a href="http://react-china.org/" target="_blank">React 中文社区</a> | <a href="https://docschina.org/" target="_blank">印记中文</a>
  </section>
</footer>

  </div>

  <div id="fb-root"></div>
  <script src="/react/js/anchor-links.js"></script>
  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?90a1e60298dddada1b7ae4159625031b";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })(); 
  </script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-45453476-6', 'auto');
    ga('send', 'pageview');
</script>
</body>
</html>
